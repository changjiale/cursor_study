# Kafka 05-高可用架构——面试考点速查

## 一、考点概览
- Kafka高可用架构设计原则
- 多副本机制与数据可靠性保障
- Leader选举与故障自动切换
- 分区重平衡与数据迁移
- 跨机房/多数据中心部署
- 灾难恢复与备份策略
- 监控告警与故障检测
- 高可用配置最佳实践

## 二、超高频考点
### 1. 多副本机制与数据可靠性
- 每个分区有多个副本（Replica），分布在不同的Broker上
- Leader副本处理读写请求，Follower副本同步Leader数据
- 副本数量配置（replication.factor）影响数据可靠性
- 至少需要3个副本才能保证高可用性

### 2. ISR机制与Leader选举
- ISR（In-Sync Replica）：与Leader保持同步的副本集合
- Leader失效时，从ISR中选择新的Leader
- min.insync.replicas参数控制最小同步副本数
- 只有ISR中的副本才有资格成为Leader

### 3. 故障自动切换机制
- Controller监控Broker状态，自动处理故障
- Leader失效时自动选举新Leader，保证服务连续性
- 分区重平衡确保数据分布均匀
- 故障恢复时间通常在几秒到几十秒

## 三、高频考点
### 1. 分区重平衡与数据迁移
- 新Broker加入时自动进行分区重分配
- 使用kafka-reassign-partitions工具手动重分配
- 数据迁移过程中保证数据一致性
- 重平衡对性能的影响及优化策略

### 2. 跨机房部署策略
- 同城多机房部署：低延迟，高可用
- 异地多活部署：地理容灾，数据同步
- MirrorMaker工具实现跨集群数据同步
- 网络分区处理与一致性保证

### 3. 监控与故障检测
- Broker健康状态监控
- 分区副本状态监控
- ISR变化告警
- 性能指标监控（吞吐量、延迟等）

## 四、中频考点
### 1. 灾难恢复策略
- 定期数据备份与恢复测试
- 快照备份与增量备份
- 跨集群数据同步与故障切换
- 恢复时间目标（RTO）与恢复点目标（RPO）

### 2. 高可用配置优化
- 合理的副本数量配置
- 网络拓扑优化
- 硬件资源规划
- 操作系统与JVM调优

### 3. 故障场景处理
- 网络分区处理
- 脑裂问题避免
- 数据不一致检测与修复
- 运维操作的安全执行

## 五、低频考点
### 1. KRaft模式下的高可用
- KRaft替代ZooKeeper后的高可用机制
- 元数据复制与一致性保证
- Controller选举与故障切换
- 与ZooKeeper模式的对比

### 2. 安全机制与高可用
- SSL/TLS加密通信
- SASL认证机制
- ACL权限控制
- 安全配置对高可用的影响

### 3. 云原生环境下的高可用
- Kubernetes部署的高可用考虑
- 容器化部署的故障隔离
- 云服务商特定的高可用方案
- 弹性伸缩与高可用的结合

## 六、面试重点提醒
- 深入理解多副本、ISR、Leader选举等核心机制
- 能结合实际场景说明高可用架构设计
- 熟悉故障检测、自动切换、数据迁移等运维操作
- 了解跨机房部署的挑战与解决方案
- 关注KRaft等新架构对高可用的影响

## 七、快速复习清单
- 多副本机制与数据可靠性
- ISR机制与Leader选举
- 故障自动切换与恢复
- 分区重平衡与数据迁移
- 跨机房部署策略
- 监控告警与故障检测
- 灾难恢复与备份策略
- 高可用配置最佳实践

## 八、面试技巧
- 回答高可用问题时，建议从架构设计、故障处理、运维保障三个维度展开
- 结合实际案例说明多副本、ISR等机制的作用
- 强调对故障场景的理解和应对策略
- 适当提及KRaft等新特性，体现对技术发展的关注
- 面试中遇到运维场景，建议结合具体工具和操作步骤作答 